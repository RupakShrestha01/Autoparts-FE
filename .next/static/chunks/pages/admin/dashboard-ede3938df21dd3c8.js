(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{2833:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return r(3134)}])},8662:function(e,s,r){"use strict";r.d(s,{Z:function(){return N}});var n=r(5893),a=r(3299),t=r(9008),i=r.n(t),d=r(1664),c=r.n(d),l=r(1955),o=r(7294),h=r(2920),u=r(6272),x=(r(993),r(8766)),m=r(1799),p=r(9396),j=r(9534);function f(e){var s=e.href,r=e.children,a=(0,j.Z)(e,["href","children"]);return(0,n.jsx)(c(),{href:s,children:(0,n.jsx)("a",(0,p.Z)((0,m.Z)({},a),{children:r}))})}var v=r(1163),g=r(3737);function N(e){var s=e.title,r=e.children,t=(0,a.useSession)(),d=t.status,m=t.data,p=(0,o.useContext)(x.y),j=p.state,N=p.dispatch,b=j.cart,y=(0,o.useState)(0),w=y[0],C=y[1];(0,o.useEffect)((function(){C(b.cartItems.reduce((function(e,s){return e+s.quantity}),0))}),[b.cartItems]);var E=(0,o.useState)(""),_=E[0],k=E[1],S=(0,v.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i(),{children:[(0,n.jsx)("title",{children:s?s+" - Autoparts":"Autoparts"}),(0,n.jsx)("meta",{name:"description",content:"Ecommerce Website"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(h.Ix,{position:"bottom-center",limit:1}),(0,n.jsxs)("div",{className:"flex min-h-screen flex-col justify-between sticky ",children:[(0,n.jsx)("header",{className:"",children:(0,n.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,n.jsx)(c(),{href:"/",children:(0,n.jsx)("a",{className:"text-lg font-bold",children:"Autoparts"})}),(0,n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),S.push("/search?query=".concat(_))},className:"mx-auto hidden justify-center md:flex",children:[(0,n.jsx)("input",{onChange:function(e){return k(e.target.value)},type:"text",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"Search products"}),(0,n.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,n.jsx)(g.Z,{className:"h-5 w-5"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c(),{href:"/cart",children:(0,n.jsxs)("a",{className:"p-2",children:["Cart",w>0&&(0,n.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:w})]})}),"loading"===d?"Loading":(null===m||void 0===m?void 0:m.user)?(0,n.jsxs)(u.v,{as:"div",className:"relative inline-block ",children:[(0,n.jsx)(u.v.Button,{className:"text-blue-600 ",children:m.user.name}),(0,n.jsxs)(u.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-gray-400 shadow-lg ",children:[(0,n.jsx)(u.v.Item,{children:(0,n.jsx)(f,{className:"dropdown-link hover:text-white",href:"/profile",children:"Profile"})}),(0,n.jsx)(u.v.Item,{children:(0,n.jsx)(f,{className:"dropdown-link hover:text-white",href:"/order-history",children:"Order History"})}),m.user.isAdmin&&(0,n.jsx)(u.v.Item,{children:(0,n.jsx)(f,{className:"dropdown-link hover:text-white",href:"/admin/dashboard",children:"Admin Dashboard"})}),(0,n.jsx)(u.v.Item,{children:(0,n.jsx)("a",{className:"dropdown-link hover:text-white",href:"#",onClick:function(){l.Z.remove("cart"),N({type:"CART_RESET"}),(0,a.signOut)({callbackUrl:"/login"})},children:"Logout"})})]})]}):(0,n.jsx)(c(),{href:"/login",children:(0,n.jsx)("a",{className:"p-2",children:"Login"})})]})]})}),(0,n.jsx)("main",{className:"container m-auto mt-4 px-4",children:r}),(0,n.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:(0,n.jsx)("p",{children:"Copyright \xa9 2022 Autoparts"})})]})]})}},3134:function(e,s,r){"use strict";r.r(s),r.d(s,{options:function(){return f}});var n=r(7568),a=r(1799),t=r(9396),i=r(4051),d=r.n(i),c=r(5893),l=r(8945),o=r(1664),h=r.n(o),u=r(5430),x=r(3148),m=r(7294),p=r(8662),j=r(3250);x.kL.register(x.uw,x.f$,x.ZL,x.Dx,x.u,x.De);var f={responsive:!0,plugins:{legend:{position:"top"}}};function v(e,s){switch(s.type){case"FETCH_REQUEST":return(0,t.Z)((0,a.Z)({},e),{loading:!0,error:""});case"FETCH_SUCCESS":return(0,t.Z)((0,a.Z)({},e),{loading:!1,summary:s.payload,error:""});case"FETCH_FAIL":return(0,t.Z)((0,a.Z)({},e),{loading:!1,error:s.payload})}}function g(){var e=(0,m.useReducer)(v,{loading:!0,summary:{salesData:[]},error:""}),s=e[0],r=s.loading,a=s.error,t=s.summary,i=e[1];(0,m.useEffect)((function(){var e=function(){var e=(0,n.Z)(d().mark((function e(){var s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i({type:"FETCH_REQUEST"}),e.next=4,l.Z.get("/api/admin/summary");case 4:s=e.sent.data,i({type:"FETCH_SUCCESS",payload:s}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),i({type:"FETCH_FAIL",payload:(0,j.b)(e.t0)});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var o={labels:t.salesData.map((function(e){return e._id})),datasets:[{label:"Sales",backgroundColor:"rgba(162, 222, 208, 1)",data:t.salesData.map((function(e){return e.totalSales}))}]};return(0,c.jsx)(p.Z,{title:"Admin Dashboard",children:(0,c.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-5",children:[(0,c.jsx)("div",{children:(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:(0,c.jsx)(h(),{href:"/admin/dashboard",children:(0,c.jsx)("a",{className:"font-bold",children:"Dashboard"})})}),(0,c.jsx)("li",{children:(0,c.jsx)(h(),{href:"/admin/orders",children:"Orders"})}),(0,c.jsx)("li",{children:(0,c.jsx)(h(),{href:"/admin/products",children:"Products"})}),(0,c.jsx)("li",{children:(0,c.jsx)(h(),{href:"/admin/users",children:"Users"})})]})}),(0,c.jsxs)("div",{className:"md:col-span-3",children:[(0,c.jsx)("h1",{className:"mb-4 text-xl",children:"Admin Dashboard"}),r?(0,c.jsx)("div",{children:"Loading..."}):a?(0,c.jsx)("div",{className:"alert-error",children:a}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[(0,c.jsxs)("div",{className:"card m-5 p-5",children:[(0,c.jsxs)("p",{className:"text-3xl",children:["$",t.ordersPrice," "]}),(0,c.jsx)("p",{children:"Sales"}),(0,c.jsx)(h(),{href:"/admin/orders",children:"View sales"})]}),(0,c.jsxs)("div",{className:"card m-5 p-5",children:[(0,c.jsxs)("p",{className:"text-3xl",children:[t.ordersCount," "]}),(0,c.jsx)("p",{children:"Orders"}),(0,c.jsx)(h(),{href:"/admin/orders",children:"View orders"})]}),(0,c.jsxs)("div",{className:"card m-5 p-5",children:[(0,c.jsxs)("p",{className:"text-3xl",children:[t.productsCount," "]}),(0,c.jsx)("p",{children:"Products"}),(0,c.jsx)(h(),{href:"/admin/products",children:"View products"})]}),(0,c.jsxs)("div",{className:"card m-5 p-5",children:[(0,c.jsxs)("p",{className:"text-3xl",children:[t.usersCount," "]}),(0,c.jsx)("p",{children:"Users"}),(0,c.jsx)(h(),{href:"/admin/users",children:"View users"})]})]}),(0,c.jsx)("h2",{className:"text-xl",children:"Sales Report"}),(0,c.jsx)(u.$Q,{options:{legend:{display:!0,position:"right"}},data:o})]})]})]})})}g.auth={adminOnly:!0},s.default=g},3250:function(e,s,r){"use strict";r.d(s,{b:function(){return n}});var n=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}}},function(e){e.O(0,[196,956,540,853,774,888,179],(function(){return s=2833,e(e.s=s);var s}));var s=e.O();_N_E=s}]);