(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return s(4984)}])},8662:function(e,r,s){"use strict";s.d(r,{Z:function(){return b}});var n=s(5893),t=s(3299),a=s(9008),i=s.n(a),c=s(1664),o=s.n(c),l=s(1955),d=s(7294),u=s(2920),h=s(6272),m=(s(993),s(8766)),x=s(1799),f=s(9396),p=s(9534);function v(e){var r=e.href,s=e.children,t=(0,p.Z)(e,["href","children"]);return(0,n.jsx)(o(),{href:r,children:(0,n.jsx)("a",(0,f.Z)((0,x.Z)({},t),{children:s}))})}var j=s(1163),w=s(3737);function b(e){var r=e.title,s=e.children,a=(0,t.useSession)(),c=a.status,x=a.data,f=(0,d.useContext)(m.y),p=f.state,b=f.dispatch,g=p.cart,N=(0,d.useState)(0),y=N[0],k=N[1];(0,d.useEffect)((function(){k(g.cartItems.reduce((function(e,r){return e+r.quantity}),0))}),[g.cartItems]);var Z=(0,d.useState)(""),_=Z[0],A=Z[1],E=(0,j.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i(),{children:[(0,n.jsx)("title",{children:r?r+" - Autoparts":"Autoparts"}),(0,n.jsx)("meta",{name:"description",content:"Ecommerce Website"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(u.Ix,{position:"bottom-center",limit:1}),(0,n.jsxs)("div",{className:"flex min-h-screen flex-col justify-between sticky ",children:[(0,n.jsx)("header",{className:"",children:(0,n.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,n.jsx)(o(),{href:"/",children:(0,n.jsx)("a",{className:"text-lg font-bold",children:"Autoparts"})}),(0,n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),E.push("/search?query=".concat(_))},className:"mx-auto hidden justify-center md:flex",children:[(0,n.jsx)("input",{onChange:function(e){return A(e.target.value)},type:"text",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"Search products"}),(0,n.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,n.jsx)(w.Z,{className:"h-5 w-5"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o(),{href:"/cart",children:(0,n.jsxs)("a",{className:"p-2",children:["Cart",y>0&&(0,n.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:y})]})}),"loading"===c?"Loading":(null===x||void 0===x?void 0:x.user)?(0,n.jsxs)(h.v,{as:"div",className:"relative inline-block ",children:[(0,n.jsx)(h.v.Button,{className:"text-blue-600 ",children:x.user.name}),(0,n.jsxs)(h.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-gray-400 shadow-lg ",children:[(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/profile",children:"Profile"})}),(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/order-history",children:"Order History"})}),x.user.isAdmin&&(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/admin/dashboard",children:"Admin Dashboard"})}),(0,n.jsx)(h.v.Item,{children:(0,n.jsx)("a",{className:"dropdown-link hover:text-white",href:"#",onClick:function(){l.Z.remove("cart"),b({type:"CART_RESET"}),(0,t.signOut)({callbackUrl:"/login"})},children:"Logout"})})]})]}):(0,n.jsx)(o(),{href:"/login",children:(0,n.jsx)("a",{className:"p-2",children:"Login"})})]})]})}),(0,n.jsx)("main",{className:"container m-auto mt-4 px-4",children:s}),(0,n.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:(0,n.jsx)("p",{children:"Copyright \xa9 2022 Autoparts"})})]})]})}},4984:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return j}});var n=s(7568),t=s(1799),a=s(9396),i=s(4051),c=s.n(i),o=s(5893),l=s(8662),d=s(1664),u=s.n(d),h=s(7294),m=s(3299),x=s(7536),f=s(3250),p=s(2920),v=s(1163);function j(){var e=(0,m.useSession)().data,r=(0,v.useRouter)(),s=r.query.redirect;(0,h.useEffect)((function(){(null===e||void 0===e?void 0:e.user)&&r.push(s||"/")}),[r,e,s]);var i=(0,x.cI)(),d=i.handleSubmit,j=i.register,w=i.formState.errors,b=function(){var e=(0,n.Z)(c().mark((function e(r){var s,n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.email,n=r.password,e.prev=1,e.next=4,(0,m.signIn)("credentials",{redirect:!1,email:s,password:n});case 4:(t=e.sent).error&&p.Am.error(t.error),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p.Am.error((0,f.b)(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}();return(0,o.jsx)(l.Z,{title:"Login",children:(0,o.jsxs)("form",{className:"mx-auto max-w-screen-md",onSubmit:d(b),children:[(0,o.jsx)("h1",{className:"mb-4 text-xl",children:"Login"}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"email",children:"Email"}),(0,o.jsx)("input",(0,a.Z)((0,t.Z)({type:"email"},j("email",{required:"Please enter email",pattern:{value:/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$/i,message:"Please enter valid email"}})),{className:"w-full",id:"email",autoFocus:!0})),w.email&&(0,o.jsx)("div",{className:"text-red-500",children:w.email.message})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"password",children:"Password"}),(0,o.jsx)("input",(0,a.Z)((0,t.Z)({type:"password"},j("password",{required:"Please enter password",minLength:{value:6,message:"password is more than 5 chars"}})),{className:"w-full",id:"password",autoFocus:!0})),w.password&&(0,o.jsx)("div",{className:"text-red-500 ",children:w.password.message})]}),(0,o.jsx)("div",{className:"mb-4 ",children:(0,o.jsx)("button",{className:"primary-button",children:"Login"})}),(0,o.jsxs)("div",{className:"mb-4 ",children:["Don't have an account?",(0,o.jsx)(u(),{href:"/register?redirect=".concat(s||"/"),children:"Register"})]})]})})}},3250:function(e,r,s){"use strict";s.d(r,{b:function(){return n}});var n=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}},7568:function(e,r,s){"use strict";function n(e,r,s,n,t,a,i){try{var c=e[a](i),o=c.value}catch(l){return void s(l)}c.done?r(o):Promise.resolve(o).then(n,t)}function t(e){return function(){var r=this,s=arguments;return new Promise((function(t,a){var i=e.apply(r,s);function c(e){n(i,t,a,c,o,"next",e)}function o(e){n(i,t,a,c,o,"throw",e)}c(void 0)}))}}s.d(r,{Z:function(){return t}})}},function(e){e.O(0,[956,536,774,888,179],(function(){return r=6429,e(e.s=r);var r}));var r=e.O();_N_E=r}]);