(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{46:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/placeorder",function(){return t(5243)}])},2913:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(5893);t(7294);function n(e){var s=e.activeStep,t=void 0===s?0:s;return(0,r.jsx)("div",{className:"mb-5 flex flex-wrap",children:["User Login","Shipping Address","Payment Method","Place Order"].map((function(e,s){return(0,r.jsx)("div",{className:"flex-1 border-b-2  \n            text-center \n         ".concat(s<=t?"border-indigo-500   text-indigo-500":"border-gray-400 text-gray-400","\n            \n         "),children:e},e)}))})}},8662:function(e,s,t){"use strict";t.d(s,{Z:function(){return b}});var r=t(5893),n=t(3299),i=t(9008),c=t.n(i),a=t(1664),d=t.n(a),l=t(1955),h=t(7294),o=t(2920),x=t(6272),u=(t(993),t(8766)),m=t(1799),j=t(9396),p=t(9534);function f(e){var s=e.href,t=e.children,n=(0,p.Z)(e,["href","children"]);return(0,r.jsx)(d(),{href:s,children:(0,r.jsx)("a",(0,j.Z)((0,m.Z)({},n),{children:t}))})}var v=t(1163),N=t(3737);function b(e){var s=e.title,t=e.children,i=(0,n.useSession)(),a=i.status,m=i.data,j=(0,h.useContext)(u.y),p=j.state,b=j.dispatch,g=p.cart,y=(0,h.useState)(0),w=y[0],k=y[1];(0,h.useEffect)((function(){k(g.cartItems.reduce((function(e,s){return e+s.quantity}),0))}),[g.cartItems]);var S=(0,h.useState)(""),_=S[0],E=S[1],I=(0,v.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:s?s+" - Autoparts":"Autoparts"}),(0,r.jsx)("meta",{name:"description",content:"Ecommerce Website"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(o.Ix,{position:"bottom-center",limit:1}),(0,r.jsxs)("div",{className:"flex min-h-screen flex-col justify-between sticky ",children:[(0,r.jsx)("header",{className:"",children:(0,r.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,r.jsx)(d(),{href:"/",children:(0,r.jsx)("a",{className:"text-lg font-bold",children:"Autoparts"})}),(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),I.push("/search?query=".concat(_))},className:"mx-auto hidden justify-center md:flex",children:[(0,r.jsx)("input",{onChange:function(e){return E(e.target.value)},type:"text",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"Search products"}),(0,r.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,r.jsx)(N.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d(),{href:"/cart",children:(0,r.jsxs)("a",{className:"p-2",children:["Cart",w>0&&(0,r.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:w})]})}),"loading"===a?"Loading":(null===m||void 0===m?void 0:m.user)?(0,r.jsxs)(x.v,{as:"div",className:"relative inline-block ",children:[(0,r.jsx)(x.v.Button,{className:"text-blue-600 ",children:m.user.name}),(0,r.jsxs)(x.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-gray-400 shadow-lg ",children:[(0,r.jsx)(x.v.Item,{children:(0,r.jsx)(f,{className:"dropdown-link hover:text-white",href:"/profile",children:"Profile"})}),(0,r.jsx)(x.v.Item,{children:(0,r.jsx)(f,{className:"dropdown-link hover:text-white",href:"/order-history",children:"Order History"})}),m.user.isAdmin&&(0,r.jsx)(x.v.Item,{children:(0,r.jsx)(f,{className:"dropdown-link hover:text-white",href:"/admin/dashboard",children:"Admin Dashboard"})}),(0,r.jsx)(x.v.Item,{children:(0,r.jsx)("a",{className:"dropdown-link hover:text-white",href:"#",onClick:function(){l.Z.remove("cart"),b({type:"CART_RESET"}),(0,n.signOut)({callbackUrl:"/login"})},children:"Logout"})})]})]}):(0,r.jsx)(d(),{href:"/login",children:(0,r.jsx)("a",{className:"p-2",children:"Login"})})]})]})}),(0,r.jsx)("main",{className:"container m-auto mt-4 px-4",children:t}),(0,r.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:(0,r.jsx)("p",{children:"Copyright \xa9 2022 Autoparts"})})]})]})}},5243:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var r=t(7568),n=t(1799),i=t(9396),c=t(4051),a=t.n(c),d=t(5893),l=t(8945),h=t(5675),o=t.n(h),x=t(1664),u=t.n(x),m=t(1163),j=t(1955),p=t(7294),f=t(2920),v=t(2913),N=t(8662),b=t(3250),g=t(8766);function y(){var e=(0,p.useContext)(g.y),s=e.state,t=e.dispatch,c=s.cart,h=c.cartItems,x=c.shippingAddress,y=c.paymentMethod,w=function(e){return Math.round(100*e+Number.EPSILON)/100},k=w(h.reduce((function(e,s){return e+s.quantity*s.price}),0)),S=k>200?0:15,_=w(.15*k),E=w(k+S+_),I=(0,m.useRouter)();(0,p.useEffect)((function(){y||I.push("/payment")}),[y,I]);var P=(0,p.useState)(!1),A=P[0],C=P[1],Z=function(){var e=(0,r.Z)(a().mark((function e(){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),e.next=4,l.Z.post("/api/orders",{orderItems:h,shippingAddress:x,paymentMethod:y,itemsPrice:k,shippingPrice:S,taxPrice:_,totalPrice:E});case 4:s=e.sent.data,C(!1),t({type:"CART_CLEAR_ITEMS"}),j.Z.set("cart",JSON.stringify((0,i.Z)((0,n.Z)({},c),{cartItems:[]}))),I.push("/order/".concat(s._id)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),C(!1),f.Am.error((0,b.b)(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return(0,d.jsxs)(N.Z,{title:"Place Order",children:[(0,d.jsx)(v.Z,{activeStep:3}),(0,d.jsx)("h1",{className:"mb-4 text-xl",children:"Place Order"}),0===h.length?(0,d.jsxs)("div",{children:["Cart is empty. ",(0,d.jsx)(u(),{href:"/",children:"Go shopping"})]}):(0,d.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-5",children:[(0,d.jsxs)("div",{className:"overflow-x-auto md:col-span-3",children:[(0,d.jsxs)("div",{className:"card p-5",children:[(0,d.jsx)("h2",{className:"mb-2 text-lg",children:"Shipping Address"}),(0,d.jsxs)("div",{children:[x.fullName,", ",x.address,","," ",x.city,", ",x.postalCode,","," ",x.country]}),(0,d.jsx)("div",{children:(0,d.jsx)(u(),{href:"/shipping",children:"Edit"})})]}),(0,d.jsxs)("div",{className:"card p-5",children:[(0,d.jsx)("h2",{className:"mb-2 text-lg",children:"Payment Method"}),(0,d.jsx)("div",{children:y}),(0,d.jsx)("div",{children:(0,d.jsx)(u(),{href:"/payment",children:"Edit"})})]}),(0,d.jsxs)("div",{className:"card overflow-x-auto p-5",children:[(0,d.jsx)("h2",{className:"mb-2 text-lg",children:"Order Items"}),(0,d.jsxs)("table",{className:"min-w-full",children:[(0,d.jsx)("thead",{className:"border-b",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-5 text-left",children:"Item"}),(0,d.jsx)("th",{className:" p-5 text-right",children:"Quantity"}),(0,d.jsx)("th",{className:" p-5 text-right",children:"Price"}),(0,d.jsx)("th",{className:"p-5 text-right",children:"Subtotal"})]})}),(0,d.jsx)("tbody",{children:h.map((function(e){return(0,d.jsxs)("tr",{className:"border-b",children:[(0,d.jsx)("td",{children:(0,d.jsx)(u(),{href:"/product/".concat(e.slug),children:(0,d.jsxs)("a",{className:"flex items-center",children:[(0,d.jsx)(o(),{src:e.image,alt:e.name,width:50,height:50}),"\xa0",e.name]})})}),(0,d.jsx)("td",{className:" p-5 text-right",children:e.quantity}),(0,d.jsxs)("td",{className:"p-5 text-right",children:["$",e.price]}),(0,d.jsxs)("td",{className:"p-5 text-right",children:["$",e.quantity*e.price]})]},e._id)}))})]}),(0,d.jsx)("div",{children:(0,d.jsx)(u(),{href:"/cart",children:"Edit"})})]})]}),(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"card p-5",children:[(0,d.jsx)("h2",{className:"mb-2 text-lg",children:"Order Summary"}),(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:(0,d.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,d.jsx)("div",{children:"Items"}),(0,d.jsxs)("div",{children:["$",k]})]})}),(0,d.jsx)("li",{children:(0,d.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,d.jsx)("div",{children:"Tax"}),(0,d.jsxs)("div",{children:["$",_]})]})}),(0,d.jsx)("li",{children:(0,d.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,d.jsx)("div",{children:"Shipping"}),(0,d.jsxs)("div",{children:["$",S]})]})}),(0,d.jsx)("li",{children:(0,d.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,d.jsx)("div",{children:"Total"}),(0,d.jsxs)("div",{children:["$",E]})]})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{disabled:A,onClick:Z,className:"primary-button w-full",children:A?"Loading...":"Place Order"})})]})]})})]})]})}y.auth=!0},3250:function(e,s,t){"use strict";t.d(s,{b:function(){return r}});var r=function(e){return e.response&&e.response.data&&e.response.data.message?e.response.data.message:e.message}}},function(e){e.O(0,[956,540,675,774,888,179],(function(){return s=46,e(e.s=s);var s}));var s=e.O();_N_E=s}]);