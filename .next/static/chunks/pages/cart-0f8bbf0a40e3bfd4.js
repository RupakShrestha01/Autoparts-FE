(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return r(7521)}])},8662:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(5893),s=r(3299),a=r(9008),i=r.n(a),l=r(1664),o=r.n(l),u=r(1955),c=r(7294),d=r(2920),h=r(6272),f=(r(993),r(8766)),m=r(1799),p=r(9396),x=r(9534);function v(e){var t=e.href,r=e.children,s=(0,x.Z)(e,["href","children"]);return(0,n.jsx)(o(),{href:t,children:(0,n.jsx)("a",(0,p.Z)((0,m.Z)({},s),{children:r}))})}var y=r(1163),j=r(3737);function b(e){var t=e.title,r=e.children,a=(0,s.useSession)(),l=a.status,m=a.data,p=(0,c.useContext)(f.y),x=p.state,b=p.dispatch,_=x.cart,g=(0,c.useState)(0),w=g[0],N=g[1];(0,c.useEffect)((function(){N(_.cartItems.reduce((function(e,t){return e+t.quantity}),0))}),[_.cartItems]);var k=(0,c.useState)(""),C=k[0],E=k[1],Z=(0,y.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i(),{children:[(0,n.jsx)("title",{children:t?t+" - Autoparts":"Autoparts"}),(0,n.jsx)("meta",{name:"description",content:"Ecommerce Website"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(d.Ix,{position:"bottom-center",limit:1}),(0,n.jsxs)("div",{className:"flex min-h-screen flex-col justify-between sticky ",children:[(0,n.jsx)("header",{className:"",children:(0,n.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[(0,n.jsx)(o(),{href:"/",children:(0,n.jsx)("a",{className:"text-lg font-bold",children:"Autoparts"})}),(0,n.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Z.push("/search?query=".concat(C))},className:"mx-auto hidden justify-center md:flex",children:[(0,n.jsx)("input",{onChange:function(e){return E(e.target.value)},type:"text",className:"rounded-tr-none rounded-br-none p-1 text-sm focus:ring-0",placeholder:"Search products"}),(0,n.jsx)("button",{className:"rounded rounded-tl-none rounded-bl-none bg-amber-300 p-1 text-sm dark:text-black",type:"submit",id:"button-addon2",children:(0,n.jsx)(j.Z,{className:"h-5 w-5"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(o(),{href:"/cart",children:(0,n.jsxs)("a",{className:"p-2",children:["Cart",w>0&&(0,n.jsx)("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:w})]})}),"loading"===l?"Loading":(null===m||void 0===m?void 0:m.user)?(0,n.jsxs)(h.v,{as:"div",className:"relative inline-block ",children:[(0,n.jsx)(h.v.Button,{className:"text-blue-600 ",children:m.user.name}),(0,n.jsxs)(h.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-gray-400 shadow-lg ",children:[(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/profile",children:"Profile"})}),(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/order-history",children:"Order History"})}),m.user.isAdmin&&(0,n.jsx)(h.v.Item,{children:(0,n.jsx)(v,{className:"dropdown-link hover:text-white",href:"/admin/dashboard",children:"Admin Dashboard"})}),(0,n.jsx)(h.v.Item,{children:(0,n.jsx)("a",{className:"dropdown-link hover:text-white",href:"#",onClick:function(){u.Z.remove("cart"),b({type:"CART_RESET"}),(0,s.signOut)({callbackUrl:"/login"})},children:"Logout"})})]})]}):(0,n.jsx)(o(),{href:"/login",children:(0,n.jsx)("a",{className:"p-2",children:"Login"})})]})]})}),(0,n.jsx)("main",{className:"container m-auto mt-4 px-4",children:r}),(0,n.jsx)("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:(0,n.jsx)("p",{children:"Copyright \xa9 2022 Autoparts"})})]})]})}},638:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6856).Z;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=i.default,a={loading:function(e){e.error,e.isLoading;return e.pastDelay,null}};n(e,Promise)?a.loader=function(){return e}:"function"===typeof e?a.loader=e:"object"===typeof e&&(a=s({},a,e));!1;(a=s({},a,t)).loadableGenerated&&delete(a=s({},a,a.loadableGenerated)).loadableGenerated;if("boolean"===typeof a.ssr&&!a.suspense){if(!a.ssr)return delete a.ssr,l(r,a);delete a.ssr}return r(a)},t.noSSR=l;var s=r(6495).Z,a=r(2648).Z,i=(a(r(7294)),a(r(4302)));function l(e,t){return delete t.webpack,delete t.modules,e(t)}("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var n=(0,r(2648).Z)(r(7294)).default.createContext(null);t.LoadableContext=n},4302:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9658).Z,s=r(7222).Z;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(6495).Z,i=(0,r(2648).Z)(r(7294)),l=r(6319),o=r(7294).useSyncExternalStore,u=[],c=[],d=!1;function h(e){var t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then((function(e){return r.loading=!1,r.loaded=e,e})).catch((function(e){throw r.loading=!1,r.error=e,e})),r}var f=function(){function e(t,r){n(this,e),this._loadFn=t,this._opts=r,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}return s(e,[{key:"promise",value:function(){return this._res.promise}},{key:"retry",value:function(){var e=this;this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};var t=this._res,r=this._opts;t.loading&&("number"===typeof r.delay&&(0===r.delay?this._state.pastDelay=!0:this._delay=setTimeout((function(){e._update({pastDelay:!0})}),r.delay)),"number"===typeof r.timeout&&(this._timeout=setTimeout((function(){e._update({timedOut:!0})}),r.timeout))),this._res.promise.then((function(){e._update({}),e._clearTimeouts()})).catch((function(t){e._update({}),e._clearTimeouts()})),this._update({})}},{key:"_update",value:function(e){this._state=a({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach((function(e){return e()}))}},{key:"_clearTimeouts",value:function(){clearTimeout(this._delay),clearTimeout(this._timeout)}},{key:"getCurrentValue",value:function(){return this._state}},{key:"subscribe",value:function(e){var t=this;return this._callbacks.add(e),function(){t._callbacks.delete(e)}}}]),e}();function m(e){return function(e,t){var r=function(){if(!u){var t=new f(e,s);u={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return u.promise()},n=function(){r();var e=i.default.useContext(l.LoadableContext);e&&Array.isArray(s.modules)&&s.modules.forEach((function(t){e(t)}))},s=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null,suspense:!1},t);s.suspense&&(s.lazy=i.default.lazy(s.loader));var u=null;if(!d){var h=s.webpack?s.webpack():s.modules;h&&c.push((function(e){var t=!0,n=!1,s=void 0;try{for(var a,i=h[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var l=a.value;if(-1!==e.indexOf(l))return r()}}catch(o){n=!0,s=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw s}}}))}var m=s.suspense?function(e,t){return n(),i.default.createElement(s.lazy,a({},e,{ref:t}))}:function(e,t){n();var r=o(u.subscribe,u.getCurrentValue,u.getCurrentValue);return i.default.useImperativeHandle(t,(function(){return{retry:u.retry}}),[]),i.default.useMemo((function(){return r.loading||r.error?i.default.createElement(s.loading,{isLoading:r.loading,pastDelay:r.pastDelay,timedOut:r.timedOut,error:r.error,retry:u.retry}):r.loaded?i.default.createElement((t=r.loaded)&&t.__esModule?t.default:t,e):null;var t}),[e,r])};return m.preload=function(){return r()},m.displayName="LoadableComponent",i.default.forwardRef(m)}(h,e)}function p(e,t){for(var r=[];e.length;){var n=e.pop();r.push(n(t))}return Promise.all(r).then((function(){if(e.length)return p(e,t)}))}m.preloadAll=function(){return new Promise((function(e,t){p(u).then(e,t)}))},m.preloadReady=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise((function(t){var r=function(){return d=!0,t()};p(c,e).then(r,r)}))},window.__NEXT_PRELOADREADY=m.preloadReady;var x=m;t.default=x},7521:function(e,t,r){"use strict";r.r(t);var n=r(7568),s=r(1799),a=r(9396),i=r(9815),l=r(4051),o=r.n(l),u=r(5893),c=r(5675),d=r.n(c),h=r(1664),f=r.n(h),m=r(7294),p=r(9965),x=r(8662),v=r(8766),y=r(1163),j=r(5152),b=r.n(j),_=r(8945),g=r(2920);function w(){var e=(0,y.useRouter)(),t=(0,m.useContext)(v.y),r=t.state,l=t.dispatch,c=r.cart.cartItems,h=function(){var e=(0,n.Z)(o().mark((function e(t,r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Number(r),e.next=3,_.Z.get("/api/products/".concat(t._id));case 3:if(!(e.sent.data.countInStock<n)){e.next=6;break}return e.abrupt("return",g.Am.error("Sorry. Product is out of stock"));case 6:l({type:"CART_ADD_ITEM",payload:(0,a.Z)((0,s.Z)({},t),{quantity:n})}),g.Am.success("Product updated in the cart");case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return(0,u.jsxs)(x.Z,{title:"Shopping Cart",children:[(0,u.jsx)("h1",{className:"mb-4 text-xl",children:"Shopping Cart"}),0===c.length?(0,u.jsxs)("div",{children:["Cart is empty. ",(0,u.jsx)(f(),{href:"/",children:"Go shopping"})]}):(0,u.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-5",children:[(0,u.jsx)("div",{className:"overflow-x-auto md:col-span-3",children:(0,u.jsxs)("table",{className:"min-w-full ",children:[(0,u.jsx)("thead",{className:"border-b",children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{className:"p-5 text-left",children:"Item"}),(0,u.jsx)("th",{className:"p-5 text-right",children:"Quantity"}),(0,u.jsx)("th",{className:"p-5 text-right",children:"Price"}),(0,u.jsx)("th",{className:"p-5",children:"Action"})]})}),(0,u.jsx)("tbody",{children:c.map((function(e){return(0,u.jsxs)("tr",{className:"border-b",children:[(0,u.jsx)("td",{children:(0,u.jsx)(f(),{href:"/product/".concat(e.slug),children:(0,u.jsxs)("a",{className:"flex items-center",children:[(0,u.jsx)(d(),{src:e.image,alt:e.name,width:50,height:50}),"\xa0",e.name]})})}),(0,u.jsx)("td",{className:"p-5 text-right",children:(0,u.jsx)("select",{value:e.quantity,onChange:function(t){return h(e,t.target.value)},children:(0,i.Z)(Array(e.countInStock).keys()).map((function(e){return(0,u.jsx)("option",{value:e+1,children:e+1},e+1)}))})}),(0,u.jsxs)("td",{className:"p-5 text-right",children:["$",e.price]}),(0,u.jsx)("td",{className:"p-5 text-center",children:(0,u.jsx)("button",{onClick:function(){return function(e){l({type:"CART_REMOVE_ITEM",payload:e})}(e)},children:(0,u.jsx)(p.Z,{className:"h-5 w-5"})})})]},e.slug)}))})]})}),(0,u.jsx)("div",{className:"card p-5",children:(0,u.jsxs)("ul",{children:[(0,u.jsx)("li",{children:(0,u.jsxs)("div",{className:"pb-3 text-xl",children:["Subtotal (",c.reduce((function(e,t){return e+t.quantity}),0),") : $",c.reduce((function(e,t){return e+t.quantity*t.price}),0)]})}),(0,u.jsx)("li",{children:(0,u.jsx)("button",{onClick:function(){return e.push("login?redirect=/shipping")},className:"primary-button w-full",children:"Check Out"})})]})})]})]})}t.default=b()((function(){return Promise.resolve(w)}),{ssr:!1})},5152:function(e,t,r){e.exports=r(638)},9965:function(e,t,r){"use strict";var n=r(7294);const s=n.forwardRef((function(e,t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))}));t.Z=s}},function(e){e.O(0,[956,540,675,774,888,179],(function(){return t=8086,e(e.s=t);var t}));var t=e.O();_N_E=t}]);